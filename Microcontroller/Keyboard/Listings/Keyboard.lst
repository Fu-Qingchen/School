C51 COMPILER V9.59.0.0   KEYBOARD                                                          11/14/2018 00:01:09 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE KEYBOARD
OBJECT MODULE PLACED IN .\Objects\Keyboard.obj
COMPILER INVOKED BY: E:\Keil_v5\C51\BIN\C51.EXE Keyboard.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\
                    -Keyboard.lst) TABS(2) OBJECT(.\Objects\Keyboard.obj)

line level    source

   1          /*************************************************
   2          * @Author: fuqingchen@whut.edu.cn
   3          * @Date: 2018-11-12 20:06:29
   4          * @Description: 电话键盘&拨号的模拟
   5          *************************************************/
   6          
   7          #include <reg51.h>
   8          #include <intrins.h>
   9          #define KEY P0  //分别读取A,B,C,D,1,2,3
  10          #define LCD P1  //分别控制D0,D1,D2,D3,D4,D5,D6,D7
  11          sbit RS = P2 ^ 0; //控制RS
  12          sbit RW = P2 ^ 1; //控制RW
  13          sbit E  = P2 ^ 2; //控制E
  14          
  15          /*************************************************
  16          * @Description: 延时函数
  17          * @Input: t:延长的时间
  18          *************************************************/
  19          void delay(unsigned int t) {
  20   1        unsigned char i;
  21   1        while (t--) {
  22   2          for (i = 0; i<120; i++);
  23   2        }
  24   1      }
  25          
  26          /*************************************************
  27          * @Description: LCD1602读状态(查忙)
  28          *************************************************/
  29          void check_busy_LCD() {
  30   1        unsigned char pin;
  31   1        do
  32   1        {
  33   2          pin = 0xff;
  34   2          E = 0;
  35   2          RS = 0; RW = 1; E = 1;  //LCD读状态控制信号
  36   2          pin = LCD;
  37   2        } while (pin & 0x80);
  38   1        E = 0;
  39   1      }
  40          
  41          /*************************************************
  42          * @Description: LCD1602写命令
  43          * @Input: com:要写入的命令
  44          *************************************************/
  45          void write_command_LCD(unsigned char com) {
  46   1        check_busy_LCD();
  47   1        RS = 0; RW = 0; //LCD写命令控制信号
  48   1        E = 0; LCD = com; E = 1;  //写命令正脉冲
  49   1        _nop_(); E = 0; delay(1);
  50   1      }
  51          
  52          /*************************************************
  53          * @Description: LCD1602写数据
  54          * @Input: date:要写入的数据
C51 COMPILER V9.59.0.0   KEYBOARD                                                          11/14/2018 00:01:09 PAGE 2   

  55          *************************************************/
  56          void write_data_LCD(unsigned char date) {
  57   1        check_busy_LCD();
  58   1        RS = 1; RW = 0; //LCD写数据控制信号
  59   1        E = 0; LCD = date; E = 1; //写数据正脉冲
  60   1        _nop_(); E = 0; delay(1);
  61   1      }
  62          
  63          /*************************************************
  64          * @Description: LCD1602初始化
  65          *************************************************/
  66          void initial_LCD() {
  67   1        write_command_LCD(0x38);  //两行显示，5*7点阵，8位数据接口
  68   1        _nop_();
  69   1        write_command_LCD(0x0C);  //整体显示，光标关，无显示
  70   1        _nop_();
  71   1        write_command_LCD(0x04);  //整屏不移位
  72   1        _nop_();
  73   1        write_command_LCD(0x01);  //显示清屏
  74   1      }
  75          
  76          /*************************************************
  77          * @Description: LCD1602显示字符串
  78          * @Input: address:字符串位置;*s:字符串;length:字符串长度
  79          *************************************************/
  80          void show_string_LCD(unsigned char address, unsigned char *s, unsigned int length) {
  81   1        unsigned int i;
  82   1        write_command_LCD(address);
  83   1        delay(5);
  84   1        for (i = 0; i < length; i++)
  85   1        {
  86   2          write_data_LCD(*(s + i));
  87   2        }
  88   1      }
  89          
  90          /*************************************************
  91          * @Description: 输入 * 时删除一位输入
  92          *************************************************/
  93          void get_star() {
  94   1        ;
  95   1      }
  96          
  97          /*************************************************
  98          * @Description: 输入 # 时清屏
  99          *************************************************/
 100          void get_sign() {
 101   1        write_command_LCD(0x01);  //显示清屏
 102   1        delay(50);
 103   1        show_string_LCD(0x82, "#FU_QINGCHEN", 12);
 104   1        _nop_();
 105   1        delay(500);
 106   1      }
 107          
 108          /*************************************************
 109          * @Description: 输入 数字 时显示号码
 110          * @Input: i: 输入的号码
 111          *************************************************/
 112          void get_num(unsigned int i) {
 113   1        show_string_LCD(0xC0, "56678", 5);
 114   1        delay(500);
 115   1        show_string_LCD(0xC0, "56678", 5);
 116   1        delay(500);
C51 COMPILER V9.59.0.0   KEYBOARD                                                          11/14/2018 00:01:09 PAGE 3   

 117   1      }
*** WARNING C280 IN LINE 112 OF Keyboard.c: 'i': unreferenced local variable
 118          
 119          void main() {
 120   1        char s[16] = "0";
 121   1        initial_LCD();
 122   1        while (1)
 123   1        {
 124   2          get_sign();
 125   2          get_num(5);
 126   2          write_command_LCD(0x01);  //清屏
 127   2          delay(5);
 128   2        }
 129   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    293    ----
   CONSTANT SIZE    =     35    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      26
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
